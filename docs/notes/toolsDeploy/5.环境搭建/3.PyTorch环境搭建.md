---
title: PyTorch环境搭建
createTime: 2025/10/02 16:51:17
permalink: /toolsDeploy/owzo8qft/
---

## 检查系统CUDA版本

- Windows
```bash
nvidia-smi.exe
```

![](https://raw.githubusercontent.com/AliceSpring123/img/main/cuda%20version.png)

- Ubuntu

```bash
# 安装驱动
sudo apt install nvidia-driver-535 
# 重启系统，让新驱动生效
sudo reboot
# 查看驱动最高支持的CUDA版本
nvidia-smi
```
![](https://raw.githubusercontent.com/AliceSpring123/img/main/Snipaste_2025-09-03_18-14-47.png)


## 安装PyTorch脚手架


### Windows
- **方式1 - 命令行安装**

  进入官网 [PyTorch](https://pytorch.org/get-started/locally/)，选择对应平台和CUDA版本

  ![](https://raw.githubusercontent.com/AliceSpring123/img/main/安装pytorch1.png)

  复制命令执行
  ```bash
  pip3 install torch torchvision --index-url https://download.pytorch.org/whl/cu129
  ```

- **方式2 - 下载离线包**

  进入网址 [PyTorch离线包](https://download.pytorch.org/whl/torch_stable.html)

  ![](https://raw.githubusercontent.com/AliceSpring123/img/main/安装pytorch2-1.png)

  找到下载文件所在的文件夹，运行命令：
  ```bash
  pip install "cu121/torchvision-0.18.1%2Bcu121-cp38-cp38-win_amd64.whl"
  ```


- 测试环境

命令行运行：
```bash
python
>>> import torch
>>> print(torch.cuda.is_available())
```
返回 `True` 表示安装成功，`False` 表示安装失败。

![](https://raw.githubusercontent.com/AliceSpring123/img/main/安装成功.png)

### Ubuntu

1. 升级系统CUDA版本(可选)
   - 移除旧版本(关键步骤)
      ```bash
      # 卸载所有通过apt安装的cuda工具包包
      sudo apt --purge remove "*cuda*" "*cublas*" "*cufft*" "*cufile*" "*curand*" "*cusolver*" "*cusparse*" "*gds-tools*" "*npp*" "*nvjpeg*" "nsight*" "*nvvm*"
      # 注意：这个命令不会移除NVIDIA驱动本身
      sudo apt autoremove
      ```
   - 下载[CUDA Toolkit](https://developer.nvidia.com/cuda-downloads), 选择平台（`Linux` -> `x86_64` -> `Ubuntu` -> `24.04` -> `deb (network)`）
   - 按照官方提示的安装指令安装新版本的CUDA Toolkit
   - 更新环境变量`.bashrc`
      ```bash
      # 替换原来的环境变量
      export PATH=/usr/local/cuda/bin${PATH:+:${PATH}}
      export LD_LIBRARY_PATH=/usr/local/cuda/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}
      ```

   - 让更改立即生效：
      ```bash
      source ~/.bashrc
      ```
   - 检查cuda版本
      ```bash
      nvcc --version
      ```
    ![](https://raw.githubusercontent.com/AliceSpring123/img/main/undefinedSnipaste_2025-09-03_18-14-47.png)
2. 下载对应[pyTorch包](https://pytorch.org/get-started/locally/)
   ![](https://raw.githubusercontent.com/AliceSpring123/img/main/Snipaste_2025-09-03_20-00-31.png)
3. 测试验证(python命令行)

   ```python
   import torch
   torch.cuda.is_available()
   ```

## 检查版本对应关系

![](https://raw.githubusercontent.com/AliceSpring123/img/main/版本对应.png)


命令行运行：
```bash
pip list
```

查看 `PyTorch` 和 `torchvision` 的版本是否对应

![](https://raw.githubusercontent.com/AliceSpring123/img/main/版本对应2.png)


## 解决版本不匹配问题

如果发现 `PyTorch` 和 `torchvision` 的版本不匹配，可以通过以下方式解决：

1. 卸载当前版本：
   ```bash
   pip uninstall torch torchvision
   ```

2. 重新安装匹配的版本：
   ```bash
   pip install torch==<version> torchvision==<version> --index-url https://download.pytorch.org/whl/cu129
   ```
