---
title: Vim
createTime: 2025/10/02 16:49:08
permalink: /toolsDeploy/wjua96kk/
---


## 常用命令示意图
![vim常用命令示意图](https://raw.githubusercontent.com/AliceSpring123/img/main/vim常用命令示意图.png)

## vim与vi
vim是vi的增强版，是 Linux 众多发行版的默认文本编辑器，所以，通常系统都已经默认安装好了 vi 或 vim 文本编辑器。

注意：CentOS中使用到的是vi，没有vim

如果输入vim，出现下面的提示，就证明没有安装vim
```shell
-bash: vim: command not found
```

使用yum安装下，就可以了
```shell
yum install vim -y
```

## vim的三种模式
vim有三种模式，分别是命令模式、插入模式和底线命令模式。这三种模式的作用分别是:
- **一般命令模式**：此状态下敲击键盘动作会被 Vim 识别为命令，而非输入字符。
- **输入模式**：在命令模式下通过按下 `i`、`a`、`o` 等按键进入输入模式。
- **底线命令模式**：用户在命令模式按下`:`后便进入底线命令模式。

![vim工作模式](https://raw.githubusercontent.com/AliceSpring123/img/main/vim工作模式.png)

## vim的使用
### 一般命令模式
- 移动光标
  <table>
  <thead>
    <tr>
      <th colspan="2" style="text-align:center" width="50%">移动光标的方法</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>h或←</td>
      <td>左移一个字符</td>
    </tr>
    <tr>
      <td>j或↓</td>
      <td>下移一个字符</td>
    </tr>
    <tr>
      <td>k或↑</td>
      <td>上移一个字符</td>
    </tr>
    <tr>
      <td>l(小写L)或→</td>
      <td>右移一个字符</td>
    </tr>
    <tr>
      <td colspan="2">可以使用组合按键如: 30↑或30j， 分别表示向上移动30行和向下移动30行</td>
    </tr>
    <tr>
      <td>[ctrl]+[f] 或 [Page Down]</td>
      <td>向下翻一页✱</td>
    </tr>
    <tr>
      <td>[ctrl]+[b] 或 [Page Up]</td>
      <td>向上翻一页✱</td>
    </tr>
    <tr>
      <td>+</td>
      <td>移动到非空格符的下一行</td>
    </tr>
    <tr>
      <td>-</td>
      <td>移动到非空格符的上一行</td>
    </tr>
    <tr>
      <td>n[space]</td>
      <td>向右移动n个字符</td>
    </tr>
    <tr>
      <td>n[Enter]</td>
      <td>向下移动n行✱</td>
    </tr>
    <tr>
      <td>数字[0] 或 [Home]</td>
      <td>移动到本行最开头✱</td>
    </tr>
    <tr>
      <td>$ 或 [End]</td>
      <td>移动到本行最末尾✱</td>
    </tr>
    <tr>
      <td>H</td>
      <td>移动到当前屏幕的第一行第一个字符</td>
    </tr>
    <tr>
      <td>L</td>
      <td>移动到当前屏幕的末尾行第一个字符</td>
    </tr>
    <tr>
      <td>G</td>
      <td>移动到当前文件的最后一行✱</td>
    </tr>
    <tr>
      <td>nG</td>
      <td>移动到当前文件的第n行✱</td>
    </tr>
    <tr>
      <td>gg</td>
      <td>移动到当前文件第一行✱</td>
    </tr>
    <tr>
      <td>n[Enter]</td>
      <td>n为数字，光标向下移动n行✱</td>
    </tr>
  </tbody>
  </table>

- 查找与替换
  <table>
    <thead>
      <tr>
        <th colspan="2" style="text-align:center" width="50%">查找与替换</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>/word</td>
        <td>向下查找字符串</td>
      </tr>
      <tr>
        <td>?word</td>
        <td>向上查找字符串</td>
      </tr>
      <tr>
        <td>按键 n</td>
        <td>继续下一个查找</td>
      </tr>
      <tr>
        <td>按键 N</td>
        <td>返回上一个查找</td>
      </tr>
      <tr >
        <td colspan="2">使用/word配合n及N是非常有帮助的，可以实现一些高级操作</td>
      </tr>
      <tr>
        <td>:n1,n2s/word1/word2/gc</td>
        <td>在第n1行与第n2行之间寻找word1这个字符串，<br>并将该字符串替换为word2，<br>末尾加c可在替换前向用户确认是否需要替换</td>
      </tr>
    </tbody>
  </table>

- 删除、复制与粘贴
  <table>
    <thead>
      <tr>
        <th colspan="2" style="text-align:center" width="50%">删除、复制与粘贴</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>x</td>
        <td>向后删除一个字符，相当于[Del]✱</td>
      </tr>
      <tr>
        <td>nx</td>
        <td>n为数字，删除光标所在的向后n个字符✱</td>
      </tr>
      <tr>
        <td>X</td>
        <td>向前删除一个字符，相当于[Backspace]✱</td>
      </tr>
      <tr>
        <td>dd</td>
        <td>删除(剪切)光标所在的一整行✱</td>
      </tr>
      <tr>
        <td>ndd</td>
        <td>n为数字，删除(剪切)光标所在的向下n行✱</td>
      </tr>
      <tr>
        <td>dgg</td>
        <td>删除(剪切)从当前行到第一行的所有数据✱</td>
      </tr>
      <tr>
        <td>dG</td>
        <td>删除(剪切)从当前行到最后一行的所有数据✱</td>
      </tr>
      <tr>
        <td>d0</td>
        <td>删除(剪切)从当前光标到本行第一个字符✱</td>
      </tr>
      <tr>
        <td>d$</td>
        <td>删除(剪切)从当前光标到本行最后一个字符✱</td>
      </tr>
      <tr>
        <td>yy</td>
        <td>复制光标所在的一整行✱</td>
      </tr>
      <tr>
        <td>nyy</td>
        <td>复制光标所在的向下n整行✱</td>
      </tr>
      <tr>
        <td>ygg</td>
        <td>复制从当前行到第一行的所有数据✱</td>
      </tr>
      <tr>
        <td>yG</td>
        <td>复制从当前行到末尾行的所有数据✱</td>
      </tr>
      <tr>
        <td>y0</td>
        <td>复制从当前光标到当前行首的所有数据✱</td>
      </tr>
      <tr>
        <td>y$</td>
        <td>复制从当前光标到当前行尾的所有数据✱</td>
      </tr>
      <tr>
        <td>p</td>
        <td>将已复制的内容粘贴在光标下一行✱</td>
      </tr>
      <tr>
        <td>P</td>
        <td>将已复制的内容粘贴在光标上一行✱</td>
      </tr>
      <tr>
        <td>J</td>
        <td>将当前行与下一行合并成一行</td>
      </tr>
      <tr>
        <td>c</td>
        <td>重复删除多个数据，例如向下删除10行: [10cj]</td>
      </tr>
      <tr>
        <td>u</td>
        <td>撤销✱</td>
      </tr>
      <tr>
        <td>[ctrl]+[r]</td>
        <td>重做✱</td>
      </tr>
      <tr>
        <td>小数点 .</td>
        <td>重复前一操作</td>
      </tr>
    </tbody>
  </table>

### 编辑模式
- 进入编辑模式
  <table>
    <thead>
      <tr>
        <th colspan="2" style="text-align:center" width="50%">进入编辑模式</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>i</td>
        <td>从当前光标进入插入模式✱</td>
      </tr>
      <tr>
        <td>a</td>
        <td>从当前光标所在的下一个字符进入插入模式</td>
      </tr>
      <tr>
        <td>A</td>
        <td>从当前行的最末字符进入插入模式</td>
      </tr>
      <tr>
        <td>o</td>
        <td>从当前光标的下一行进入插入模式✱</td>
      </tr>
      <tr>
        <td>O</td>
        <td>从当前光标的上一行进入插入模式✱</td>
      </tr>
      <tr>
        <td>r</td>
        <td>进入替换模式，替换光标所在的字符一次</td>
      </tr>
      <tr>
        <td>R</td>
        <td>进入替换模式，一直替换光标所在文字，直至按下[Esc]</td>
      </tr>
      <tr>
        <td>[Esc]</td>
        <td>退出编辑模式✱</td>
      </tr>
    </tbody>
  </table>

### 底线命令模式
- 保存、退出、查找、替换
  <table>
    <thead>
      <tr>
        <th colspan="2" style="text-align:center" width="50%">保存、退出、查找、替换</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>:w</td>
        <td>保存✱</td>
      </tr>
      <tr>
        <td>:wq</td>
        <td>保存并退出✱</td>
      </tr>
      <tr>
        <td>:q</td>
        <td>退出✱</td>
      </tr>
      <tr>
        <td>:q!</td>
        <td>强制退出，不保存✱</td>
      </tr>
      <tr>
        <td>:w [filename]</td>
        <td>另存为[filename]</td>
      </tr>
      <tr>
        <td>:r [filename]</td>
        <td>将另一个文件[filename]中的内容加入到当前行的后面</td>
      </tr>
      <tr>
        <td>:n1,n2 w [filename]</td>
        <td>将第n1行到第n2行的内容另存为文件[filename]中</td>
      </tr>
      <tr>
        <td>:! command</td>
        <td>暂时退出vim，返回命令行模式下执行command命令<br>例如: [:! ls /home] 暂时退出vim执行ls /home命令</td>
      </tr>
      <tr>
        <td colspan="2">vim显示界面的修改</td>
      </tr>
      <tr>
        <td>:set nu</td>
        <td>显示行号</td>
      </tr>
      <tr>
        <td>:set nonu</td>
        <td>取消行号</td>
      </tr>

    </tbody>
  </table>
<br>


## 可视区块模式
Vim 的 Visual Block（可视块模式）是一种选择文本的方式，允许你以矩形块的形式选择文本，而不是按行或单词选择。这种模式在处理列数据或需要对多行进行相同编辑时非常有用。

举例来说，有下面格式的文件
```txt
192.168.1.100   host1.class.net
192.168.1.101   host2.class.net
192.168.1.102   host3.class.net
192.168.1.103   host4.class.net
```
想修改成如下内容
```txt
192.168.2.100   host1.class.net   host1
192.168.2.101   host2.class.net   host2
192.168.2.102   host3.class.net   host3
192.168.2.103   host4.class.net   host4
```

使用普通修改方式较为繁琐，此时可以使用vim的可视区块模式:

> 1. 光标移动到第一行的host字符前，按下ctrl+v进入可视区块模式
> 2. 移动光标到最底部，此时可以看到所有行的host字符都被反白
> 3. 按下y复制选择的数据

![可视区块模式-复制数据](https://raw.githubusercontent.com/AliceSpring123/img/main/vim可视区块1.png)

> 4. 在第一行按下i进入插入模式，光标移动到最右边指定位置退出插入模式
> 5. 按p粘贴数据
> 6. 按Esc退出可视区块模式

![可视区块模式-粘贴数据](https://raw.githubusercontent.com/AliceSpring123/img/main/vim可视区块2.png)

可视区块模式下的操作：
<table>
  <thead>
    <tr>
      <th colspan="2" style="text-align:center" width="50%">可视区块模式的按键意义</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ctrl+v</td>
      <td>进入可视区块模式，可以使用矩形的方式选择数据</td>
    </tr>
    <tr>
      <td>h, j, k, l 或 ←, ↓, ↑, →</td>
      <td>移动光标</td>
    </tr>
    <tr>
      <td>v</td>
      <td>字符选择，会将光标经过的字符反白选择</td>
    </tr>
    <tr>
      <td>V</td>
      <td>行选择，会将光标经过行反白选择</td>
    </tr>
    <tr>
      <td>y</td>
      <td>复制选择的数据</td>
    </tr>
    <tr>
      <td>d</td>
      <td>删除选择的数据</td>
    </tr>
    <tr>
      <td>p</td>
      <td>粘贴选择的数据</td>
    </tr>
    <tr>
      <td>Esc</td>
      <td>退出可视区块模式</td>
    </tr>
  </tbody>
</table>

## 多文件编辑
我们可以使用vim同时打开好几个文件进行多文件编辑。
- 打开多个文件
  ```shell  
  vim filename1 filename2 filename3
  ```

- 多文件编辑操作(在命令模式下)
  ```shell
  :n 切换到下一个文件
  :N 切换到上一个文件
  :files 查看当前打开的文件
  :close 关闭当前文件
  :q 关闭所有文件，退出vim
  ```

## 多窗口功能
在打开一个文件后，在普通模式下使用以下命令可以多窗口打开多个文件
- 打开新文件
  ```shell
  :sp [filename]
  ```


- 切换下一窗口
  ```shell
  ctrl + w + j
  ctrl + w + ↓
  ```

- 切换上一窗口  
  ```shell
  ctrl + w + k
  ctrl + w + ↑
  ```

- 关闭当前窗口
  ```shell
  ctrl + w + c
  ```
  ![多窗口功能](https://raw.githubusercontent.com/AliceSpring123/img/main/多窗口.png)

<br>
